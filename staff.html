<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Staff â€” Noir Vicent 2025</title>

    <style>
        body {
            background: black;
            color: #f1f1f1;
            font-family: Arial, sans-serif;
            padding: 20px;
            text-align: center;
        }

        h1 {
            color: #d4af37;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
        }

        th, td {
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        th {
            color: #d4af37;
        }

        .status-confirmado {
            color: #6dff6d;
            font-weight: bold;
        }

        .status-pendente {
            color: #ff6d6d;
            font-weight: bold;
        }

        input {
            padding: 6px;
            width: 90%;
            border-radius: 6px;
            text-align: center;
        }

        button {
            padding: 7px 10px;
            border: none;
            background: #d4af37;
            color: black;
            font-weight: bold;
            cursor: pointer;
            border-radius: 6px;
        }

        button:hover {
            background: #f0cd64;
        }

        .footer {
            margin-top: 35px;
            opacity: .6;
        }
    </style>
</head>
<body>

    <h1>ðŸ“‹ Lista de Convidados â€” Staff Noir Vicent</h1>

    <table id="tabela">
        <tr>
            <th>Nome</th>
            <th>CÃ³digo</th>
            <th>Status</th>
            <th>Mesa</th>
            <th>Salvar</th>
        </tr>
    </table>

    <p class="footer">Noir Vicent 2025 â€” Staff</p>

<!-- ===================== FIREBASE ========================= -->
<script type="module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCkCgElrFjbRc-WQ7A2rRh_Ncx2Ffe2QI4",
      authDomain: "noir-vicent.firebaseapp.com",
      projectId: "noir-vicent",
      storageBucket: "noir-vicent.firebasestorage.app",
      messagingSenderId: "339381996402",
      appId: "1:339381996402:web:3cfc311705c4ea6f64abeb"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ===================== CARREGAR LISTA =====================
    async function carregarConvidados() {
        const tabela = document.getElementById("tabela");

        // limpa
        tabela.innerHTML = `
            <tr>
                <th>Nome</th>
                <th>CÃ³digo</th>
                <th>Status</th>
                <th>Mesa</th>
                <th>Salvar</th>
            </tr>
        `;

        const snapshot = await getDocs(collection(db, "convidados"));

        snapshot.forEach(docSnap => {
            const c = docSnap.data();

            let linha = document.createElement("tr");

            linha.innerHTML = `
                <td>${c.nome}</td>
                <td>${c.codigo}</td>
                <td class="${c.status === 'confirmado' ? 'status-confirmado' : 'status-pendente'}">
                    ${c.status}
                </td>
                <td>
                    <input 
                        id="mesa-${c.codigo}" 
                        value="${c.mesa ? c.mesa : ''}" 
                        placeholder="${c.status === 'confirmado' ? 'Ex: CafÃ©' : '-'}"
                        ${c.status === 'pendente' ? 'disabled' : ''}
                    >
                </td>
                <td>
                    <button ${c.status === 'pendente' ? 'disabled' : ''} onclick="salvarMesa('${c.codigo}')">
                        Salvar
                    </button>
                </td>
            `;

            tabela.appendChild(linha);
        });
    }

    // ===================== SALVAR MESA =====================
    async function salvarMesa(codigo) {
        const valor = document.getElementById("mesa-" + codigo).value;

        await updateDoc(doc(db, "convidados", codigo), {
            mesa: valor
        });

        alert("Mesa atualizada com sucesso!");
    }

    window.salvarMesa = salvarMesa;
    carregarConvidados();

</script>

</body>
</html>
